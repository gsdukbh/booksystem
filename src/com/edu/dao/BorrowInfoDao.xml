<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.edu.dao.BorrowInfoDao">
     <!--查看所有借阅信息-->
    <select id="findAllBorrowMsg" resultType="BorrowInfo" parameterType="BorrowInfo" >
        select top(${rows}) * from borrowInfo
        where  id  not in(
            select top(${start}) id from  borrowInfo order by id asc
        )
        order by id asc
    </select>
    <!-- 查询总数 -->
    <select id="selectBorrowListCount" 
            resultType="Integer">
        select count(*) from BorrowInfo
    </select>
    <select id="findBorrowById"  parameterType="String"   resultType="BorrowInfo">
        select * from   borrowinfo where   borrowID=#{borrowID}  and  bookId=#{bookId}
    </select>
    <!--包括借阅id,图书id-->
    <select id="findBorrowMsgById" parameterType="BorrowInfo" resultType="BorrowInfo">
      select * from   borrowinfo
        <where>
            <if test="borrowID !=null and borrowID !=''">
                <bind name="borrowID" value="'%'+_parameter.getBorrowID()+'%'" />
             and  borrowID=#{borrowID}
            </if>
            <if test="bookId !=null and bookId !=''">
                <bind name="bookId" value="'%'+_parameter.getBookId()+'%'" />
                and  bookId=#{bookId}
            </if>
        </where>
    </select>
    <!--增加借阅信息-->
    <insert id="addBorrowMsg" parameterType="BorrowInfo"  >
        insert into  borrowinfo(
                                borrowID,
                                bookId,           
                                borrowstatus
                                ) 
        values (
               #{borrowID},
               #{bookId},
               #{borrowstatus}
               )  
    </insert>
    <!--修改信息-->
    <update id="upBorrowMsg" parameterType="BorrowInfo"  >
        update borrowinfo
        <set>
            <if test="borrowRenewDay !=null and borrowRenewDay !=''">
                borrowRenewDay=#{borrowRenewDay} ,
            </if>
            <if test="borrowRemandDay !=null and borrowRemandDay !=''">
                borrowRemandDay=#{borrowRemandDay},
            </if>
            <if test="borrowPenalty !=null and borrowPenalty !=''">
                borrowPenalty=#{borrowPenalty}  ,
            </if>
            <if test="borrowstatus !=null and borrowstatus !=''">
                borrowstatus=#{borrowstatus} ,
            </if>
        </set>
            where  borrowID=#{borrowID} and bookId=#{bookId}
    </update>
    <!--删除信息通过id-->
    <delete id="delBorrowMsgByid" parameterType="String" >
        delete from  borrowinfo  where borrowID =#{borrowID} and bookId =#{bookId}
    </delete>
</mapper>
